var bigintCryptoUtils=function(a){'use strict';function c(b){return b=BigInt(b),b>=B?b:-b}function d(b){return p(b,1)}function e(c,d){if(c=BigInt(c),d=BigInt(d),c<=B|d<=B)return NaN;let e=B,f=C,g=C,h=B;for(;c!==B;){let a=d/c,b=d%c,i=e-g*a,j=f-h*a;d=c,c=b,e=g,f=h,g=i,h=j}return{b:d,x:e,y:f}}function f(d,e){if(d=c(d),e=c(e),d===B)return e;if(e===B)return d;let f=B;for(;!((d|e)&C);)d>>=C,e>>=C,f++;for(;!(d&C);)d>>=C;do{for(;!(e&C);)e>>=C;if(d>e){let a=d;d=e,e=a}e-=d}while(e);return d<<f}async function g(a,b=16){return"number"==typeof a&&(a=BigInt(a)),new Promise((c,d)=>{const e=new Worker(s());e.onmessage=a=>{e.terminate(),c(a.data.isPrime)},e.onmessageerror=a=>{d(a)},e.postMessage({rnd:a,iterations:b,id:0})})}function h(b,a){if(b==B|a<=B)return NaN;let c=e(o(b,a),a);return c.b===C?o(c.x,a):NaN}function i(a,b,d,f=0,j=64,k){if(d=BigInt(d),d===B)return NaN;if(d===C)return B;if(a=o(a,d),b=BigInt(b),b<B)return h(i(a,c(b),d,f,j),d);switch(+f){case 0:return t(a,b,d);case 1:return x(a,b,d);case 2:return k?u(k,b,d,j):u(a,b,d,j);case 3:return v(a,b,d,j);case 4:return y(a,b,d,j);case 5:return w(a,b,d,j);case 6:return z(a,b,d,j);default:return t(a,b,d);}}function j(a,b=C){if(a<=b)throw new Error("max must be > min");const c=a-b;let e,f=d(c);do{let a=k(f);e=q(a)}while(e>c);return e+b}function k(a,b=!1){var c=Math.ceil;if(1>a)throw new RangeError(`bitLength MUST be > 0 and it is ${a}`);const d=c(a/8);let e=l(d,!1);if(e[0]&=2**(a%8)-1,b){let b=a%8?2**(a%8-1):128;e[0]|=b}return e}function l(a,b=!1){if(1>a)throw new RangeError(`byteLength MUST be > 0 and it is ${a}`);let c;return c=new Uint8Array(a),self.crypto.getRandomValues(c),b&&(c[0]|=128),c}function o(b,c){return(c=BigInt(c),0>=c)?NaN:(b=BigInt(b)%c,0>b?b+c:b)}function p(b,d){b=c(b),d=BigInt(d);let e=1;for(;(b>>=d)>B;)e++;return e}function q(a){let b=B;for(let c of a.values()){let a=BigInt(c);b=(b<<BigInt(8))+a}return b}function r(c,b=16){if(c===D)return!0;if((c&C)===B||c===C)return!1;const e=[3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597];for(let a=0;a<e.length&&BigInt(e[a])<=c;a++){const b=BigInt(e[a]);if(c===b)return!0;if(c%b===B)return!1}let f=B,g=c-C;for(;g%D===B;)g/=D,++f;let h=(c-C)/D**f;loop:do{let a=j(c-C,D),b=i(a,h,c);if(b===C||b===c-C)continue;for(let a=1;a<f;a++){if(b=i(b,D,c),b===c-C)continue loop;if(b===C)break}return!1}while(--b);return!0}function s(){let a=`'use strict';const _ZERO = BigInt(0);const _ONE = BigInt(1);const _TWO = BigInt(2);${c};${d};${e};${h};${i};${E};${j};${k};${l};const isProbablyPrime = ${r};${o};${p};${q.toString()};${t};${v};${u};${x};${y};`;return a+=`onmessage = ${async function(a){const b=await g(a.data.rnd,a.data.iterations);postMessage({isPrime:b,value:a.data.rnd,id:a.data.id})}.toString()};`,A(a)}function t(a,b,c,d=!1){if(d){for(;(b>>=C)>B;)a=a**D%c;return a}else{let d=C;const e=[];let f=0;do e[f]=b&C,f++;while((b>>=C)>B);for(let b=f-1;0<=b;b--)d=d**D%c,e[b]===C&&(d=d*a%c);return d}}function u(a,b,c,d){Array.prototype.isArray=!0,d=BigInt(d);const f=D**d;let g;if(a.isArray&&a.length==f)g=a;else{g=Array(f),g[0]=C,g[1]=a;for(let b=2;b<f;b++)g[b]=g[b-1]*a%c}const h=[];let k=0;do h[k]=b&f-C,k++;while((b>>=d)>B);let l=C;for(let e=k-1;0<=e;e--)l=t(l,f,c,!0),h[e]>B&&(l=l*g[h[e]]%c);return l}function v(a,b,c,d=512){if(c%D===B)return NaN;const f=new E(c,d);let g=f.mul(a,f.Rsqr),h=f.R-c;const k=[];let l=0;do k[l]=b&C,l++;while((b>>=C)>B);for(let e=l-1;0<=e;e--)h=f.mul(h,h),k[e]===C&&(h=f.mul(h,g));return f.mul(h,C)}function w(a,b,c,d=512){if(c%D===B)return NaN;const f=new E(c,d);let g=f.redc(a*f.Rsqr),h=f.R-c;const k=[];let l=0;do k[l]=b&C,l++;while((b>>=C)>B);for(let e=l-1;0<=e;e--)h=f.redc(h**D),k[e]===C&&(h=f.redc(h*g));return f.redc(h)}function x(a,b,c){let d=C;for(;b>B;)b%D===C&&(d=d*a%c),b>>=C,b!==B&&(a=a**D%c);return d}function y(a,b,c,d=512){if(c%D===B)return NaN;const f=new E(c,d);let g=f.mul(a,f.Rsqr),h=f.R-c;for(;b>B;)b%D===C&&(h=f.mul(h,g)),b/=D,b!==B&&(g=f.mul(g,g));return f.mul(h,C)}function z(a,b,c,d=512){if(c%D===B)return NaN;const f=new E(c,d);let g=f.redc(a*f.Rsqr),h=f.R-c;for(;b>B;)b%D===C&&(h=f.redc(h*g)),b/=D,b!==B&&(g=f.redc(g**D));return f.redc(h)}function A(a){a=`(() => {${a}})()`;const b=new Blob([a],{type:"text/javascript"});return window.URL.createObjectURL(b)}const B=BigInt(0),C=BigInt(1),D=BigInt(2);class E{constructor(a,b=512){if(a%D===B)throw new Error("In a Montgomery domain with R a power of 2, the module MUST be odd");this.m=a,this.baseBits=BigInt(b),this.b=D**this.baseBits,this.wLen=BigInt(p(a,b)),this.RBits=this.baseBits*this.wLen,this.R=D**this.RBits,this.Rsqr=this.R**D%a;let d=-h(a,this.R);c(d)>a/D&&(d=o(d,this.R)),this.mPrime=d}toMont(a){return this.redc(a*this.Rsqr)}redc(a){let b=a*this.mPrime%this.R;b<B&&(b+=this.R);const c=a+b*this.m>>this.RBits;return c>=this.m?c-this.m:c}mul(a,b){let c=B;const d=this.b-C;for(let e=0;e<this.wLen;e++){const e=c&d,f=a&d;let g=(e+f*(b&d))%this.b*this.mPrime%this.b;g<B&&(g+=this.base),c=c+f*b+g*this.m>>this.baseBits,a>B&&(a>>=this.baseBits)}return c>=this.m&&(c-=this.m),c}}return a.Mont=E,a.abs=c,a.bitLength=d,a.eGcd=e,a.gcd=f,a.isProbablyPrime=g,a.lcm=function(d,e){return d=BigInt(d),e=BigInt(e),d===B&&e===B?B:c(d*e)/f(d,e)},a.modInv=h,a.modPow=i,a.prime=function(a,b=16){if(1>a)throw new RangeError(`bitLength MUST be > 0 and it is ${a}`);return new Promise(c=>{let d=[];const e=(e,f)=>{if(e.isPrime){for(let a=0;a<d.length;a++)d[a].terminate();for(;d.length;)d.pop();c(e.value)}else{let c=k(a,!0),d=q(c);try{f.postMessage({rnd:d,iterations:b,id:e.id})}catch(a){}}};{let a=s();for(let b,c=0;c<self.navigator.hardwareConcurrency;c++)b=new Worker(a),b.onmessage=a=>e(a.data,b),d.push(b)}for(let e=0;e<d.length;e++){let c=k(a,!0),f=q(c);d[e].postMessage({rnd:f,iterations:b,id:e})}})},a.randBetween=j,a.randBits=k,a.randBytes=function(a,b=!1){if(1>a)throw new RangeError(`byteLength MUST be > 0 and it is ${a}`);let c;return new Promise(function(d){c=new Uint8Array(a),self.crypto.getRandomValues(c),b&&(c[0]|=128),d(c)})},a.randBytesSync=l,a.toZn=o,a.wordLength=p,a}({});
